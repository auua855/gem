<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Gemini Window</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" href="./icon.svg" type="image/svg+xml">
    <style>
        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        body {
            font-family: sans-serif;
            background: #121212;
            color: #ffffff;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100dvh;
            /* ã‚¹ãƒãƒ›ã®ãƒãƒ¼ã®é«˜ã•ã«åˆã‚ã›ã¦ã´ã£ãŸã‚Šã«ã™ã‚‹ã‚ˆ */
            overflow: hidden;
            /* ç”»é¢å…¨ä½“ã®ä½™è¨ˆãªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ãªãã™ã‚ˆ */
        }

        #header {
            background: #1e1e1e;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            font-size: 18px;
            position: sticky;
            /* ä¸Šã«å›ºå®šã™ã‚‹ãŠã¾ã˜ãªã„ã ã­ */
            top: 0;
            z-index: 50;
        }

        #chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .msg {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 15px;
            line-height: 1.6;
            font-size: 16px;
            white-space: pre-wrap;
            /* æ”¹è¡Œã‚’åæ˜ ã•ã›ã‚‹ */
        }

        .user {
            align-self: flex-end;
            background: #2b5278;
            /* è½ã¡ç€ã„ãŸé’ */
            color: white;
            border-bottom-right-radius: 2px;
        }

        .ai {
            align-self: flex-start;
            background: #1e1e1e;
            color: #eeeeee;
            border-bottom-left-radius: 2px;
            border: 1px solid #333;
        }

        /* ãƒ­ãƒ¼ãƒ‰ä¸­ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–¢é€£ */
        .loading-container {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #888;
            font-size: 13px;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 3px solid #333;
            border-top: 3px solid #888;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢å‘¨è¾º */
        #file-preview {
            display: none;
            padding: 8px 15px;
            font-size: 12px;
            color: #aaa;
            background: #1a1a1a;
            border-top: 1px solid #333;
        }

        #input-area {
            background: #1e1e1e;
            padding: 10px 15px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            border-top: 1px solid #333;
        }

        .icon-btn {
            background: transparent;
            color: #888;
            border: none;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s, color 0.2s;
        }

        .icon-btn:hover {
            background: #333;
            color: #fff;
        }

        textarea {
            flex: 1;
            background: #2d2d2d;
            color: #ffffff;
            border: 1px solid #444;
            padding: 10px 12px;
            border-radius: 20px;
            outline: none;
            resize: none;
            max-height: 120px;
            font-family: inherit;
            font-size: 16px;
            overflow-y: auto;
        }

        textarea::placeholder {
            color: #888;
        }

        /* ç´™é£›è¡Œæ©Ÿã‚¢ã‚¤ã‚³ãƒ³ã®ã‚µã‚¤ã‚ºèª¿æ•´ */
        .icon-btn svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        /* è¨­å®šç”»é¢ */
        #settings-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 20px;
            box-sizing: border-box;
            z-index: 100;
            overflow-y: auto;
        }

        #settings-overlay input,
        #settings-overlay textarea {
            background: #2d2d2d;
            color: #fff;
            border: 1px solid #555;
            padding: 10px;
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 15px;
        }

        /* PINãƒ­ãƒƒã‚¯ç”»é¢ */
        #pin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #121212;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }

        #pin-input {
            font-size: 24px;
            padding: 10px;
            text-align: center;
            letter-spacing: 5px;
            width: 150px;
            background: #333;
            color: white;
            border: 1px solid #555;
            border-radius: 8px;
            margin-top: 20px;
        }
    </style>
</head>

<body>

    <div id="pin-overlay">
        <h2>Enter PIN</h2>
        <input type="tel" id="pin-input" maxlength="4" placeholder="****" autocomplete="off">
        <p id="pin-error" style="color: #ff4444; display: none; margin-top: 10px;">Incorrect PIN</p>
    </div>

    <div id="header">
        <div style="display: flex; align-items: baseline;">
            <span id="ai-name-display" style="font-weight: bold; letter-spacing: 1px; font-size: 20px;">gemini</span>
            <span id="char-count" style="font-size: 14px; color: #888; margin-left: 15px;">0 æ–‡å­—</span>
        </div>
        <button class="icon-btn" onclick="toggleSettings()">âš™ï¸</button>
    </div>

    <div id="chat-container"></div>

    <div id="file-preview">
        <span id="file-name"></span>
        <button onclick="clearFile()"
            style="background:none; border:none; color:#ff4444; cursor:pointer; margin-left:10px;">âœ–</button>
    </div>

    <div id="input-area">
        <button class="icon-btn" onclick="document.getElementById('file-input').click()" title="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜">
            ğŸ“
        </button>
        <input type="file" id="file-input" style="display:none;" onchange="handleFileSelect()">

        <textarea id="user-input" rows="1" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."></textarea>

        <button class="icon-btn" onclick="sendMessage()" title="é€ä¿¡">
            <svg viewBox="0 0 24 24">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
            </svg>
        </button>
    </div>

    <div id="settings-overlay">
        <h2>è¨­å®š</h2>
        <label>APIã‚­ãƒ¼:</label><br>
        <input type="password" id="api-key"><br>
        <label>AIã®åå‰:</label><br>
        <input type="text" id="ai-name-input" placeholder="gemini"><br>
        <label>ãƒšãƒ«ã‚½ãƒŠè¨­å®š (System Instruction):</label><br>
        <textarea id="persona-setting" rows="6"></textarea>
        <button onclick="clearHistory()"
            style="width:100%; padding: 10px; background: #ff4444; color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 10px;">ä¼šè©±å±¥æ­´ã‚’æ¶ˆå»</button>
        <button onclick="saveSettings()"
            style="width:100%; padding: 15px; background: #2b5278; color: white; border: none; border-radius: 8px; cursor: pointer;">ä¿å­˜ã—ã¦é–‰ã˜ã‚‹</button>
    </div>

    <script type="importmap">
  {
    "imports": {
      "@google/generative-ai": "https://esm.run/@google/generative-ai"
    }
  }
</script>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // Service Workerã®ç™»éŒ²
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
                .then(reg => console.log('SW registered!', reg))
                .catch(err => console.log('SW registration failed: ', err));
        }

        // PINãƒ­ãƒƒã‚¯è§£é™¤ãƒ­ã‚¸ãƒƒã‚¯
        const pinInput = document.getElementById('pin-input');
        pinInput.focus();
        pinInput.addEventListener('input', (e) => {
            if (e.target.value.length === 4) {
                if (e.target.value === '6160') {
                    document.getElementById('pin-overlay').style.display = 'none';
                } else {
                    document.getElementById('pin-error').style.display = 'block';
                    e.target.value = '';
                }
            } else {
                document.getElementById('pin-error').style.display = 'none';
            }
        });

        let selectedFile = null;
        let totalCharCount = 0;
        let chatSession = null; // ä¼šè©±ã‚’è¨˜æ†¶ã™ã‚‹ãŸã‚ã®å¤‰æ•°ã ã‚ˆ
        let chatHistory = []; // ä¼šè©±å±¥æ­´ã‚’ä¿å­˜ã™ã‚‹é…åˆ—

        // åˆæœŸè¨­å®šã®èª­ã¿è¾¼ã¿
        document.getElementById('api-key').value = localStorage.getItem('gemini_api_key') || '';
        document.getElementById('persona-setting').value = localStorage.getItem('gemini_persona') || '';

        // AIã®åå‰è¨­å®šèª­ã¿è¾¼ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ geminiï¼‰
        const savedAiName = localStorage.getItem('gemini_ai_name') || 'gemini';
        document.getElementById('ai-name-input').value = savedAiName;
        document.getElementById('ai-name-display').innerText = savedAiName;
        document.title = `${savedAiName} Window`;

        // ä¼šè©±å±¥æ­´ã®èª­ã¿è¾¼ã¿
        loadHistory();

        // å…¥åŠ›æ¬„ã®é«˜ã•è‡ªå‹•èª¿æ•´
        const textarea = document.getElementById('user-input');
        textarea.addEventListener('input', function () {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        window.toggleSettings = () => {
            const overlay = document.getElementById('settings-overlay');
            overlay.style.display = overlay.style.display === 'block' ? 'none' : 'block';
        };

        window.saveSettings = () => {
            localStorage.setItem('gemini_api_key', document.getElementById('api-key').value);
            localStorage.setItem('gemini_persona', document.getElementById('persona-setting').value);

            // AIã®åå‰ä¿å­˜ã¨åæ˜ 
            const newAiName = document.getElementById('ai-name-input').value || 'gemini';
            localStorage.setItem('gemini_ai_name', newAiName);
            document.getElementById('ai-name-display').innerText = newAiName;
            document.title = `${newAiName} Window`;

            chatSession = null; // è¨­å®šã‚’å¤‰ãˆãŸã‚‰ã€è¨˜æ†¶ã‚’ä¸€åº¦ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã­
            // è¨­å®šå¤‰æ›´å¾Œã‚‚å±¥æ­´ã¯ç¶­æŒã—ãŸã„ã®ã§ã€chatSessionã®å†åˆæœŸåŒ–ã¯sendMessageå†…ã§è¡Œã†
            toggleSettings();
        };

        window.clearHistory = () => {
            if (confirm('ä¼šè©±å±¥æ­´ã‚’ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem('gemini_chat_history');
                chatHistory = [];
                document.getElementById('chat-container').innerHTML = '';
                chatSession = null;
                alert('å±¥æ­´ã‚’æ¶ˆå»ã—ã¾ã—ãŸ');
                toggleSettings();
            }
        };

        window.handleFileSelect = () => {
            const input = document.getElementById('file-input');
            if (input.files.length > 0) {
                selectedFile = input.files[0];
                document.getElementById('file-name').innerText = `æ·»ä»˜: ${selectedFile.name}`;
                document.getElementById('file-preview').style.display = 'block';
            }
        };

        window.clearFile = () => {
            selectedFile = null;
            document.getElementById('file-input').value = '';
            document.getElementById('file-preview').style.display = 'none';
        };

        const chatContainer = document.getElementById('chat-container');

        window.sendMessage = async () => {
            const apiKey = localStorage.getItem('gemini_api_key');
            const persona = localStorage.getItem('gemini_persona');
            const userText = textarea.value.trim();

            if (!apiKey || (!userText && !selectedFile)) {
                return;
            }

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            let displayMsg = userText;
            if (selectedFile) displayMsg = `[ğŸ“ ${selectedFile.name}]\n` + displayMsg;
            addMessage(displayMsg, 'user');

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›æ–‡å­—æ•°ã‚’åŠ ç®—
            totalCharCount += userText.length;
            updateCharCount();

            // å…¥åŠ›æ¬„ã‚’ãƒªã‚»ãƒƒãƒˆ
            textarea.value = '';
            textarea.style.height = 'auto';

            // ãƒ­ãƒ¼ãƒ‰ä¸­è¡¨ç¤ºã‚’è¿½åŠ 
            const loadingId = 'loading-' + Date.now();
            addLoading(loadingId);

            try {
                const genAI = new GoogleGenerativeAI(apiKey);
                const model = genAI.getGenerativeModel({
                    model: "gemini-3.1-pro-preview",
                    systemInstruction: persona
                });

                // ã¾ã ä¼šè©±ãŒå§‹ã¾ã£ã¦ã„ãªã‘ã‚Œã°ã€æ–°ã—ãã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½œã‚‹ã‚ˆ
                if (!chatSession) {
                    chatSession = model.startChat({
                        history: chatHistory
                    });
                }

                let parts = [];
                let historyPart = []; // å±¥æ­´ä¿å­˜ç”¨

                // ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆã®å‡¦ç†
                if (selectedFile) {
                    if (selectedFile.type.startsWith('image/') || selectedFile.type === 'application/pdf') {
                        const base64 = await fileToBase64(selectedFile);
                        parts.push({
                            inlineData: { data: base64, mimeType: selectedFile.type }
                        });
                    } else {
                        // ç”»åƒãƒ»PDFä»¥å¤–ã¯ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦èª­ã¿è¾¼ã‚“ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å«ã‚ã‚‹
                        const textContent = await fileToText(selectedFile);
                        parts.push(`\n\n--- æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ« (${selectedFile.name}) ã®å†…å®¹ ---\n${textContent}`);
                    }
                }

                // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
                if (userText) {
                    parts.push(userText);
                    historyPart.push(userText); // å±¥æ­´ç”¨ï¼ˆãƒ†ã‚­ã‚¹ãƒˆã®ã¿ç°¡æ˜“ä¿å­˜ï¼‰
                } else if (selectedFile) {
                    // ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã®å ´åˆã®å±¥æ­´ç”¨ãƒ†ã‚­ã‚¹ãƒˆï¼ˆç°¡æ˜“ï¼‰
                    historyPart.push(`(ãƒ•ã‚¡ã‚¤ãƒ«æ·»ä»˜: ${selectedFile.name})`);
                }

                // generateContent ã®ä»£ã‚ã‚Šã«ã€chatSession.sendMessage ã‚’ä½¿ã†ã‚ˆ
                const result = await chatSession.sendMessage(parts);
                const response = await result.response;
                const aiText = response.text();

                removeLoading(loadingId);

                // æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç”Ÿæˆ
                const now = new Date();
                const dateStr = `${now.getFullYear()}å¹´${now.getMonth() + 1}æœˆ${now.getDate()}æ—¥ã€€${now.getHours()}æ™‚${now.getMinutes()}åˆ†`;

                // AIã®è¿”ä¿¡ã«æ—¥æ™‚ã‚’è¿½åŠ 
                const aiTextWithDate = `${dateStr}\n\n${aiText}`;
                addMessage(aiTextWithDate, 'ai');

                // å±¥æ­´é…åˆ—ã‚’æ›´æ–° (Geminiã®historyå½¢å¼ã«åˆã‚ã›ã‚‹)
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼é€ä¿¡åˆ†
                // ç”»åƒãƒ‡ãƒ¼ã‚¿ãªã©ã¯localStorageã«å…¥ã‚‰ãªã„ã®ã§ã€ç°¡æ˜“çš„ã«ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ä¿å­˜
                // æœ¬æ¥ã¯ç”»åƒã‚‚Base64ã§ä¿å­˜ã§ãã‚‹ãŒå®¹é‡åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã€ã“ã“ã§ã¯ãƒ†ã‚­ã‚¹ãƒˆå±¥æ­´ã®ç¶­æŒã‚’å„ªå…ˆ

                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆè¡¨ç¤ºç”¨ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ï¼‰
                let userHistoryText = userText;
                if (selectedFile) userHistoryText = `[ğŸ“ ${selectedFile.name}]\n` + userHistoryText;

                chatHistory.push({
                    role: 'user',
                    parts: [{ text: userHistoryText }]
                });

                // AIã®è¿”ä¿¡
                chatHistory.push({
                    role: 'model',
                    parts: [{ text: aiTextWithDate }]
                });

                // AIã®è¿”ä¿¡æ–‡å­—æ•°ã‚’åŠ ç®—
                totalCharCount += aiText.length;
                updateCharCount();

                // ãƒ•ã‚¡ã‚¤ãƒ«ã®æ·»ä»˜çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
                clearFile();

                // å±¥æ­´ã‚’ä¿å­˜
                saveHistory();

            } catch (error) {
                removeLoading(loadingId);
                addMessage('ã‚¨ãƒ©ãƒ¼ã¿ãŸã„ã ã­ï¼š' + error.message, 'ai');
            }
        };



        function addMessage(text, sender) {
            const div = document.createElement('div');
            div.className = `msg ${sender}`;
            div.innerText = text;
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // å±¥æ­´é…åˆ—ã«è¿½åŠ ï¼ˆãƒ­ãƒ¼ãƒ‰æ™‚ã¯é‡è¤‡ã—ãªã„ã‚ˆã†ã«åˆ¶å¾¡ãŒå¿…è¦ã ãŒã€ä»Šå›ã¯ç°¡æ˜“çš„ã«å¸¸ã«è¿½åŠ ï¼‰
            // ãŸã ã—ã€ãƒ­ãƒ¼ãƒ‰æ™‚ã«addMessageã‚’å‘¼ã¶ã¨äºŒé‡ã«ãªã‚‹ã®ã§ã€saveHistoryã§ä¸€æ‹¬ä¿å­˜ã™ã‚‹æ–¹å¼ã«ã™ã‚‹
            // ã“ã“ã§ã¯è¡¨ç¤ºç”¨ã®å‡¦ç†ã®ã¿
        }

        function saveHistory() {
            // ç¾åœ¨ã®chatSessionã®å±¥æ­´ã‚’å–å¾—ã§ãã‚Œã°ãƒ™ã‚¹ãƒˆã ãŒã€
            // ã‚·ãƒ³ãƒ—ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å†…å®¹ã‚’ä¿å­˜ã™ã‚‹ã®ã§ã¯ãªãã€
            // APIã¨ã®ã‚„ã‚Šã¨ã‚Šã®å±¥æ­´ï¼ˆchatHistoryï¼‰ã‚’localStorageã«ä¿å­˜ã™ã‚‹

            // chatSession.getHistory() ã¯éåŒæœŸã§é‡ã„å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€
            // ç°¡æ˜“çš„ã«æ‰‹å‹•ã§ç®¡ç†ã—ã¦ã„ã‚‹ chatHistory é…åˆ—ã‚’ä¿å­˜ã™ã‚‹
            localStorage.setItem('gemini_chat_history', JSON.stringify(chatHistory));
        }

        function loadHistory() {
            const saved = localStorage.getItem('gemini_chat_history');
            if (saved) {
                chatHistory = JSON.parse(saved);
                // ç”»é¢ã«å¾©å…ƒ
                for (const msg of chatHistory) {
                    // msg = { role: 'user' | 'model', parts: [{ text: '...' }] }
                    const text = msg.parts[0].text;
                    const sender = msg.role === 'user' ? 'user' : 'ai';
                    // æ—¥æ™‚ãªã©ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®ã¾ã¾è¡¨ç¤º

                    // addMessageã‚’ä½¿ã†ã¨äºŒé‡ã«å±¥æ­´ã«è¿½åŠ ã•ã‚Œã¦ã—ã¾ã†ã®ã§ã€ç›´æ¥DOMæ“ä½œã™ã‚‹ã‹ãƒ•ãƒ©ã‚°ã§åˆ¶å¾¡
                    const div = document.createElement('div');
                    div.className = `msg ${sender}`;
                    div.innerText = text; // ã“ã“ã¯æ—¢ã«æ—¥æ™‚ä»˜ãã®ãƒ†ã‚­ã‚¹ãƒˆã«ãªã£ã¦ã„ã‚‹ã¯ãš
                    chatContainer.appendChild(div);
                }
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }

        function addLoading(id) {
            const div = document.createElement('div');
            div.className = 'ai loading-container msg';
            div.id = id;
            div.style.padding = '8px 16px';
            div.innerHTML = `<div class="spinner"></div><span>å¿œç­”ä¸­...</span>`;
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function removeLoading(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        // æ–‡å­—æ•°è¡¨ç¤ºã‚’æ›´æ–°
        function updateCharCount() {
            document.getElementById('char-count').innerText = `${totalCharCount} æ–‡å­—`;
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ç”¨ã®è£œåŠ©é–¢æ•°
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result.split(',')[1]);
                reader.onerror = error => reject(error);
            });
        }

        function fileToText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsText(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }
    </script>

</body>

</html>